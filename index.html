<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sales Summary</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 600px;
    margin: 50px auto;
    padding: 20px;
    background-color: #f9f9f9;
  }
  h1 {
    text-align: center;
  }
  #total-sales {
    font-size: 2em;
    text-align: center;
    margin-top: 20px;
    padding: 10px;
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 4px;
  }
  /* Optional: style for file input */
  #file-input {
    display: block;
    margin: 20px auto;
  }
</style>
</head>
<body>
<h1>Sales Summary</h1>
<input type="file" id="file-input" accept=".csv" />
<div id="total-sales">Loading...</div>

<script>
// Wait for the DOM to load
document.addEventListener('DOMContentLoaded', () => {
  const fileInput = document.getElementById('file-input');
  const totalSalesElement = document.getElementById('total-sales');

  // The embedded CSV data URI (base64 encoded)
  const salesCsvDataUri = "data:text/csv;base64,cHJvZHVjdCxzYWxlcwpBcHAyMCwxNTAuNTAKQmFuYW5hLDIwMC4yNQpDaGVycnksMzAw";

  // Function to decode base64 to string
  function decodeBase64(base64) {
    try {
      return decodeURIComponent(escape(atob(base64)));
    } catch (e) {
      console.error('Error decoding base64:', e);
      return '';
    }
  }

  // Function to parse CSV content
  function parseCsv(csvText) {
    const lines = csvText.trim().split('\n');
    const result = [];
    for (const line of lines) {
      // Split by comma, handle possible quoted fields if needed
      // But given the data, simple split is sufficient
      const values = line.split(',');
      result.push(values);
    }
    return result;
  }

  // Function to process CSV data and calculate total sales
  function processCsvData(csvText) {
    const rows = parseCsv(csvText);
    if (rows.length === 0) {
      totalSalesElement.textContent = '0.00';
      return;
    }
    // Find the index of the 'sales' column (assuming header row)
    const header = rows[0];
    const salesColIndex = header.findIndex(col => col.trim().toLowerCase() === 'sales');
    if (salesColIndex === -1) {
      console.error('Sales column not found');
      totalSalesElement.textContent = '0.00';
      return;
    }
    let total = 0.0;
    // Iterate over data rows
    for (let i = 1; i < rows.length; i++) {
      const row = rows[i];
      const salesStr = row[salesColIndex];
      const salesNum = parseFloat(salesStr);
      if (!isNaN(salesNum)) {
        total += salesNum;
      }
    }
    // Format to two decimal places
    totalSalesElement.textContent = total.toFixed(2);
  }

  // Function to handle file input change
  function handleFile(files) {
    if (files.length === 0) return;
    const file = files[0];
    const reader = new FileReader();
    reader.onload = () => {
      const content = reader.result;
      processCsvData(content);
    };
    reader.readAsText(file);

    // For testing, process the embedded CSV data automatically
    // Remove or comment out below lines if you want user to upload manually
    // For the test, automatically process the embedded CSV
    if (file.name === 'sales.csv' || true) {
      // Extract base64 data from the data URI
      const base64Data = salesCsvDataUri.split(',')[1];
      const csvText = decodeBase64(base64Data);
      processCsvData(csvText);
    }
  }

  // Event listener for file input
  fileInput.addEventListener('change', (e) => {
    handleFile(e.target.files);
  });

  // On page load, process the embedded CSV data
  // (simulate file upload for initial display)
  const base64Data = salesCsvDataUri.split(',')[1];
  const csvText = decodeBase64(base64Data);
  processCsvData(csvText);
});
</script>
</body>
</html>