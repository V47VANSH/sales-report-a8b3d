<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sales Summary</title>
  <style>
    /* Reset some default styles */
    body, html {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen,
        Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
      background-color: #f9f9f9;
      color: #333;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
    }
    
    .container {
      background: #fff;
      padding: 2rem 3rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      border-radius: 8px;
      max-width: 400px;
      width: 90%;
      text-align: center;
    }

    h1 {
      margin-bottom: 1.5rem;
      font-weight: 700;
      font-size: 1.8rem;
      color: #222;
    }

    #total-sales {
      font-size: 2rem;
      font-weight: 700;
      color: #2c7a7b;
      margin-bottom: 1.5rem;
      min-height: 2.5rem;
      /* to preserve space if empty initially */
    }

    /* Responsive for smaller screens */
    @media (max-width: 400px) {
      .container {
        padding: 1.5rem 1.5rem;
      }
      h1 {
        font-size: 1.5rem;
      }
      #total-sales {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Sales Summary</h1>
    <div id="total-sales">Loading...</div>
  </div>

  <script>
    // Base64 encoded CSV content from the attachment
    const base64CSV = "cHJvZHVjdCxzYWxlcwpBcHAyMCwxNTAuNTAKQmFuYW5hLDIwMC4yNQpDaGVycnksMzAw";

    // Function to decode base64 to string
    function base64Decode(base64) {
      try {
        // atob returns a string decoded from base64
        return decodeURIComponent(Array.prototype.map.call(atob(base64), function(c) {
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
      } catch (e) {
        // fallback if decodeURIComponent fails (shouldn't happen here)
        return atob(base64);
      }
    }

    // Parse CSV text to array of objects
    function parseCSV(csvText) {
      const lines = csvText.trim().split('\n');
      if (lines.length < 2) return [];

      const headers = lines[0].split(',');
      const data = [];

      for(let i = 1; i < lines.length; i++) {
        const row = lines[i].split(',');
        const obj = {};
        for(let j = 0; j < headers.length; j++) {
          obj[headers[j]] = row[j];
        }
        data.push(obj);
      }
      return data;
    }

    // Main function to process CSV and update total sales
    function processSalesData() {
      try {
        const csvText = base64Decode(base64CSV);
        const records = parseCSV(csvText);

        let total = 0;

        for(const record of records) {
          // Parse sales value as float
          const salesVal = parseFloat(record.sales);
          if (!isNaN(salesVal)) {
            total += salesVal;
          }
        }

        // Format total to exactly 2 decimal places
        const totalFormatted = total.toFixed(2);

        // Update the #total-sales element with exact text content
        const totalSalesEl = document.getElementById('total-sales');
        totalSalesEl.textContent = totalFormatted;
      } catch (err) {
        // In case of error, display a meaningful message
        const totalSalesEl = document.getElementById('total-sales');
        totalSalesEl.textContent = 'Error processing data';
        console.error('Error processing sales data:', err);
      }
    }

    // Run on page load
    window.addEventListener('DOMContentLoaded', () => {
      processSalesData();
    });
  </script>
</body>
</html>
