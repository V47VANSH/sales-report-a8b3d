<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sales Summary</title>
  <style>
    /* Basic Reset */
    html, body {
      margin: 0;
      padding: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f7f8fa;
      color: #222;
      min-height: 100vh;
    }
    body {
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    .container {
      max-width: 400px;
      margin: 60px auto 0 auto;
      background: #fff;
      border-radius: 10px;
      box-shadow: 0 2px 12px 0 rgba(0,0,0,0.05);
      padding: 32px 24px 24px 24px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    h1 {
      font-size: 2rem;
      margin-bottom: 24px;
      letter-spacing: 1px;
      font-weight: 600;
      color: #3949ab;
    }
    .summary-row {
      width: 100%;
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 12px;
      margin-bottom: 8px;
      font-size: 1.18rem;
    }
    #total-sales {
      font-weight: 700;
      font-size: 2.2rem;
      color: #2196f3;
      margin-top: 12px;
      letter-spacing: 1px;
      text-align: right;
    }
    @media (max-width: 480px) {
      .container {
        padding: 18px 8px 14px 8px;
        max-width: 97vw;
      }
      h1 {
        font-size: 1.2rem;
      }
      #total-sales {
        font-size: 1.4rem;
      }
    }
  </style>
</head>
<body>
  <main>
    <div class="container">
      <h1>Sales Summary</h1>
      <div class="summary-row">
        <span>Total Sales:</span>
        <span id="total-sales"></span>
      </div>
    </div>
  </main>
  <script>
    // Embedded base64 CSV data (from the attachment)
    const salesCsvDataUri =
      'data:text/csv;base64,cHJvZHVjdCxzYWxlcwpBcHAyMCwxNTAuNTAKQmFuYW5hLDIwMC4yNQpDaGVycnksMzAw';

    // Helper function to decode base64 (works in browser atob)
    function base64ToUtf8(b64) {
      // atob decodes base64 to binary string; decodeURIComponent(escape()) handles UTF-8
      return decodeURIComponent(escape(window.atob(b64)));
    }

    // Parse CSV text to array of objects
    function parseCsv(text) {
      const lines = text.trim().split(/\r?\n/);
      if (lines.length === 0) return [];
      const headers = lines[0].split(',');
      return lines.slice(1).map(line => {
        // Handles potential commas in future, but current data is simple
        const values = line.split(',');
        let row = {};
        headers.forEach((h, i) => {
          row[h.trim()] = values[i] !== undefined ? values[i].trim() : '';
        });
        return row;
      });
    }

    function formatNumber(val) {
      // Always show two decimal places
      return parseFloat(val).toFixed(2);
    }

    function displayTotalSales(total) {
      // Set the text content of #total-sales exactly
      const totalSalesElem = document.getElementById('total-sales');
      if (totalSalesElem) {
        totalSalesElem.textContent = formatNumber(total);
      }
    }

    // Main logic: decode, parse, sum
    (function processSalesCsv() {
      try {
        // Extract base64 from data URI
        const base64 = salesCsvDataUri.split(',')[1];
        const csvText = base64ToUtf8(base64);
        const rows = parseCsv(csvText);
        // Sum up the sales column, treating missing/invalid as 0
        let total = 0;
        for (const row of rows) {
          let sale = row['sales'] || row['Sales'];
          // Handle both possible capitalizations just in case, but expect 'sales'
          let num = Number(sale);
          if (!isNaN(num)) {
            total += num;
          }
        }
        // Display the result (should be 650.75 for the provided data)
        displayTotalSales(total);
      } catch (err) {
        // Error handling: show error in the total-sales element
        const elem = document.getElementById('total-sales');
        if (elem) {
          elem.textContent = 'Error';
        }
      }
    })();
  </script>
</body>
</html>
