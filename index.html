<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sales Summary</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 40px;
    background-color: #f9f9f9;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  h1 {
    margin-bottom: 20px;
  }
  #total-sales {
    font-size: 2em;
    font-weight: bold;
    padding: 10px 20px;
    background-color: #fff;
    border: 2px solid #ccc;
    border-radius: 8px;
    min-width: 200px;
    text-align: center;
  }
</style>
</head>
<body>
<h1>Sales Summary</h1>
<div id="total-sales">Loading...</div>
<script>
// Function to decode base64 string to text
function base64ToText(base64) {
  try {
    return decodeURIComponent(escape(atob(base64)));
  } catch (e) {
    // Fallback for older browsers
    return atob(base64);
  }
}

// Function to parse CSV data into an array of objects
function parseCSV(csvText) {
  const lines = csvText.trim().split('\n');
  const headers = lines[0].split(',');
  const data = lines.slice(1).map(line => {
    const values = line.split(',');
    const obj = {};
    headers.forEach((header, index) => {
      obj[header.trim().toLowerCase()] = values[index].trim();
    });
    return obj;
  });
  return data;
}

// Main function to process the CSV and update total
function processCSVData(csvBase64) {
  const csvText = base64ToText(csvBase64);
  const data = parseCSV(csvText);
  // Calculate sum of 'sales' column
  const total = data.reduce((sum, item) => {
    const salesValue = parseFloat(item['sales']);
    return sum + (isNaN(salesValue) ? 0 : salesValue);
  }, 0);
  // Update the DOM element with the total formatted to 2 decimal places
  const totalFormatted = total.toFixed(2);
  document.getElementById('total-sales').textContent = totalFormatted;
}

// The provided CSV data URI
const salesCsvDataUri = "data:text/csv;base64,cHJvZHVjdCxzYWxlcwpBcHAyMCwxNTAuNTAKQmFuYW5hLDIwMC4yNQpDaGVycnksMzAw";

// Extract base64 content from the data URI
const csvDataUriPattern = /^data:text\/csv;base64,(.+)$/;
const match = salesCsvDataUri.match(csvDataUriPattern);
if (match && match[1]) {
  const csvBase64 = match[1];
  // Process the CSV data
  processCSVData(csvBase64);
} else {
  document.getElementById('total-sales').textContent = 'Error loading data';
}
</script>
</body>
</html>